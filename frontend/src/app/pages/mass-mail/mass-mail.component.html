<div class="container mt-4">
  <h2>Envío masivo de correos</h2>


  <div *ngIf="mensajeVisible" class="alert">
    {{ mensaje }}
  </div>

  <div class="mb-3">
    <label for="plantilla" class="form-label">Selecciona una plantilla:</label>
    <select [(ngModel)]="plantillaSeleccionada" id="plantilla" class="form-select" required>
      <option [ngValue]="null">-- Elige una plantilla --</option>
      <option *ngFor="let p of plantillas" [ngValue]="p.id">{{ p.nombre }}</option>
    </select>
  </div>


  <div class="mb-3">
    <label for="fechaProgramada" class="form-label">Programar envío (opcional):</label>
    <input type="datetime-local" [(ngModel)]="fechaProgramada" id="fechaProgramada" class="form-control" />
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover mt-3">
      <thead>
        <tr>
          <th scope="col"><input type="checkbox" (change)="toggleSeleccionTodos($event)" /></th>
          <th scope="col">Nombre</th>
          <th scope="col">Email</th>
          <th scope="col">Empresa</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let contacto of contactos">
          <td>
            <input type="checkbox" [checked]="seleccionados.includes(contacto.id)"
              (change)="onToggleSeleccion($event, contacto.id)" />
          </td>
          <td>{{ contacto.nombre }} {{ contacto.apellidos }}</td>
          <td>{{ contacto.email }}</td>
          <td>{{ contacto.empresa }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="d-flex flex-wrap gap-2">
    <button class="btn btn-primary" (click)="enviarMasivo()">Enviar a seleccionados</button>
  </div>
</div>